import{L as h,f as o,i as v}from"./process-B5bCvn5w.js";import{h as x,A as y,f as k,i as n,C as b,v as w,j as L,B as _,k as C,c as D,o as A}from"./index-CrawaA9O.js";const z=x({__name:"WeeklyUsageChart",props:{usage:{}},setup(m){const a=m,i=y(),s=k(null);let t=null;const u=n(()=>a.usage?Math.max(...a.usage.map(e=>e.durationMs)):0),d=n(()=>u.value/2),l=n(()=>{if(!a.usage)return 0;const e=a.usage;return a.usage.length?e.reduce((r,p)=>r+p.durationMs,0)/e.length:0}),c=n(()=>({grid:{left:"3%",right:"100px",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:e=>{if(e&&e.length>0){const r=e[0];return`${r.name}<br/>${o(r.data)}`}return""}},xAxis:{type:"category",data:a.usage?[...a.usage.map(e=>b(w(e.date)))]:[],axisTick:{alignWithLabel:!1}},yAxis:{type:"value",position:"left",min:0,max:u.value,interval:d.value,splitNumber:1,axisLabel:{formatter:e=>o(e)}},series:[{type:"bar",data:a.usage?a.usage.map(e=>e.durationMs):[],itemStyle:{borderRadius:[8,8,0,0],color:new h(0,1,0,0,[{offset:0,color:"#287AF7"},{offset:1,color:"#6766EE"}])},markLine:{animationDuration:500,data:[{yAxis:l.value,label:{formatter:`平均
`+o(l.value),color:i.value?"#fff":"#000",backgroundColor:"transparent"}}]}}]})),f=()=>{t&&t.resize()},g=()=>{s.value&&(t=v(s.value),t.setOption(c.value))};return L(()=>{g(),window.addEventListener("resize",f)}),_(()=>{window.removeEventListener("resize",f)}),C([()=>a.usage,i],()=>{t&&t.setOption(c.value,!0)}),(e,r)=>(A(),D("div",{ref_key:"chartRef",ref:s,class:"w-full",style:{height:"300px"}},null,512))}});export{z as _};
