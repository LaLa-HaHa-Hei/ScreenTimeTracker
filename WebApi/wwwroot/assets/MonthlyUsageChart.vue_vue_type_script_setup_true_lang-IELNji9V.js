import{L as h,f as s,i as v}from"./process-DsZC-9zr.js";import{h as x,A as y,f as b,i as n,m as k,v as w,j as L,B as _,k as D,c as M,o as A}from"./index-Bwu9Iw44.js";const z=x({__name:"MonthlyUsageChart",props:{usage:{}},setup(m){const a=m,i=y(),o=b(null);let t=null;const u=n(()=>a.usage?Math.max(...a.usage.map(e=>e.durationMs)):0),d=n(()=>u.value/2),l=n(()=>{if(!a.usage)return 0;const e=a.usage;return a.usage.length?e.reduce((r,g)=>r+g.durationMs,0)/e.length:0}),c=n(()=>({grid:{left:"3%",right:"100px",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:e=>{if(e&&e.length>0){const r=e[0];return`${r.name}<br/>${s(r.data)}`}return""}},xAxis:{type:"category",data:a.usage?[...a.usage.map(e=>k(w(e.date)))]:[],axisTick:{alignWithLabel:!1}},yAxis:{type:"value",position:"left",min:0,max:u.value,interval:d.value,splitNumber:1,axisLabel:{formatter:e=>s(e)}},series:[{type:"bar",data:a.usage?a.usage.map(e=>e.durationMs):[],itemStyle:{borderRadius:[8,8,0,0],color:new h(0,1,0,0,[{offset:0,color:"#287AF7"},{offset:1,color:"#6766EE"}])},markLine:{animationDuration:500,data:[{yAxis:l.value,label:{formatter:`平均
`+s(l.value),color:i.value?"#fff":"#000",backgroundColor:"transparent"}}]}}]})),f=()=>{t&&t.resize()},p=()=>{o.value&&(t=v(o.value),t.setOption(c.value))};return L(()=>{p(),window.addEventListener("resize",f)}),_(()=>{window.removeEventListener("resize",f)}),D([()=>a.usage,i],()=>{t&&t.setOption(c.value,!0)}),(e,r)=>(A(),M("div",{ref_key:"chartRef",ref:o,class:"w-full",style:{height:"300px"}},null,512))}});export{z as _};
