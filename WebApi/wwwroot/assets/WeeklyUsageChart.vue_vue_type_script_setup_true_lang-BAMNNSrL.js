import{L as h,f as s,i as v}from"./process-BdcFep0L.js";import{g as x,a as y}from"./date-xHdT8iMX.js";import{g as b,v as k,f as w,h as o,i as L,x as _,j as D,c as C,o as E}from"./index-BExF4c4S.js";const R=b({__name:"WeeklyUsageChart",props:{usage:{}},setup(m){const a=m,i=k(),n=w(null);let t=null;const u=o(()=>a.usage?Math.max(...a.usage.map(e=>e.durationMs)):0),d=o(()=>u.value/2),l=o(()=>{if(!a.usage)return 0;const e=a.usage;return a.usage.length?e.reduce((r,p)=>r+p.durationMs,0)/e.length:0}),c=o(()=>({grid:{left:"3%",right:"100px",bottom:"3%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:e=>{if(e&&e.length>0){const r=e[0];return`${r.name}<br/>${s(r.data)}`}return""}},xAxis:{type:"category",data:a.usage?[...a.usage.map(e=>x(y(e.date)))]:[],axisTick:{alignWithLabel:!1}},yAxis:{type:"value",position:"left",min:0,max:u.value,interval:d.value,splitNumber:1,axisLabel:{formatter:e=>s(e)}},series:[{type:"bar",data:a.usage?a.usage.map(e=>e.durationMs):[],itemStyle:{borderRadius:[8,8,0,0],color:new h(0,1,0,0,[{offset:0,color:"#287AF7"},{offset:1,color:"#6766EE"}])},markLine:{animationDuration:500,data:[{yAxis:l.value,label:{formatter:`平均
`+s(l.value),color:i.value?"#fff":"#000",backgroundColor:"transparent"}}]}}]})),f=()=>{t&&t.resize()},g=()=>{n.value&&(t=v(n.value),t.setOption(c.value))};return L(()=>{g(),window.addEventListener("resize",f)}),_(()=>{window.removeEventListener("resize",f)}),D([()=>a.usage,i],()=>{t&&t.setOption(c.value,!0)}),(e,r)=>(E(),C("div",{ref_key:"chartRef",ref:n,class:"w-full",style:{height:"300px"}},null,512))}});export{R as _};
